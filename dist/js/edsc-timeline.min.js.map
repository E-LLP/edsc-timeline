{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/js/edsc-timeline.coffee","edsc-timeline.min.js","src/js/timeline/draggable.coffee","src/js/timeline/fencepost.coffee","src/js/util/date.js","src/js/util/plugin.coffee","src/js/util/string.js","src/js/util/svg.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","AXIS_HEIGHT","Draggable","LABELS","MAX_X","MAX_Y","MIN_X","MIN_Y","MONTHS","MS_PER_DAY","MS_PER_DECADE","MS_PER_HOUR","MS_PER_MINUTE","MS_PER_MONTH","MS_PER_YEAR","OFFSET_X","RESOLUTIONS","ROW_FONT_HEIGHT","ROW_HEIGHT","ROW_PADDING","ROW_TEXT_OFFSET","TOP_HEIGHT","TemporalFencepost","TemporalSelection","Timeline","ZOOM_LEVELS","addContext","dateUtil","formatDate","formatDay","formatMonth","formatTime","formatYear","pluginUtil","stringUtil","svgUtil","bind","fn","me","apply","arguments","extend","child","parent","ctor","this","constructor","key","hasProp","prototype","__super__","hasOwnProperty","slice","date","padLeft","getUTCHours","getUTCMinutes","getUTCDate","getUTCMonth","getUTCFullYear","dateStr","contextMatch","contextFn","result","push","left1","right1","attrs","left","right","on","update","rect","buildSvgElement","appendChild","dispose","off","parentNode","removeChild","width","x","Math","min","abs","updateSvgElement","$","superClass","root","namespace","options","ref","_finishPan","_onLabelMouseout","_onLabelMouseover","_onLabelClick","_onKeydown","_onDataMouseout","_onDataMouseover","data","_rows","addClass","attr","append","_buildDom","_createDisplay","_data","animate","_zoom","end","Date","start","originPx","_loadedRange","_updateTimeline","scope","_this","removeClass","_hasFocus","_forceRedraw","hovered","document","querySelector","currentTarget","setTimeout","destroy","find","remove","range","span","startTime","endTime","show","_setHeight","hide","focus","loadstart","id","resolution","match","getElementsByClassName","setAttribute","getAttribute","_empty","row","_getRow","intervals","color","_drawData","_drawIndicators","_","after_color","after_end","before_color","before_start","j","len","ref1","row_max","row_min","max","getElementById","el","endPos","index","len1","ref2","ref3","startPos","zoom","_buildSvgElement","_translate","timeToPosition","y","height","rx","ry","tlRows","dataTop","interval","leftEdge","matrix","nodes","rightEdge","stop","timelineTop","tooltip","target","className","baseVal","split","childNodes","text","_dateWithResolution","getScreenCTM","value","window","innerWidth","css","offset","top","str","dateToHumanUTC","indexOf","join","callback","svg","_buildRect","stroke","fill","requestAnimationFrame","refresh","rows","results","_updateRowNames","_drawTemporalBounds","timeSpanToPx","scale","pxToTimeSpan","p","positionToTime","floor","zoomIn","trigger","_deltaZoom","zoomOut","arg","center","panToTime","round","levels","center_t","timeSpan","toggleClass","t0","t1","overlay","startPt","stopPt","_focus","focusOverlay","scopedEventName","class","x1","time","_pan","_getTransformX","getTransformX","down","dx","focusEnd","up","keyCode","_roundTime","_canFocusTimespan","canFocusTimespan","_timespanForLabel","group","next","x0","previousSibling","label","_dragging","_contains","start0","end0","start1","end1","node","empty","selection","timeline","_createSelectionOverlay","y1","_setupTemporalSelection","_createFocusOverlay","_createFixedOverlay","_createTimeline","_setupDragBehavior","_setupScrollBehavior","draggable","self","arg1","cursor","selectionOverlay","_createSelectionRegion","_onUpdate","_onEnd","allowWheel","doScroll","getTime","onWheel","rateLimit","touchCenter","touchSeparation","origin","clientX","clientLeft","deltaX","deltaY","wheelDeltaX","wheelDeltaY","preventDefault","addEventListener","type","touches","commit","draggables","_panStart","_startPan","_panEnd","_panStartX","olRows","axis","background","_buildIndicatorArrow","transform","g","d","textGroup","txt","textContent","title","bbox","getBBox","firstChild","insertBefore","elWidth","k","line","loadedEnd","loadedResolution","loadedStart","x2","y2","_drawIntervals","setTemporal","ranges","_globalTemporal","setRowTemporal","temporal","globalIndexes","_createTemporalRegion","indexes","leftX","rightX","increment","c","components","UTC","prev","_buildIntervalDisplay","concat","subText","bg","circle","lineClass","subLabel","cx","rowsHeight","totalHeight","Base","create","./timeline/draggable","./timeline/fencepost","./util/date","./util/plugin","./util/string","./util/svg",2,"browserPrefix","cancelAnimFrame","getOffset","requestAnimFrame","name","cancelAnimationFrame","clearTimeout","isNaN","offsetLeft","offsetTop","scrollLeft","scrollTop","offsetParent","clientY","element","_mouseup","_mousemove","_mousedown","_element","enable","disable","removeEventListener","events","context","base","event","_listeners","listeners","splice","fire","console","log","JSON","stringify","shiftKey","which","button","stopPropagation","_preStartCursor","_startCursor","_startLoc","_currentLoc","_getLoc","_currentOffset","_currentCursor","_start","_frameId","_move","_end","_positions","_times","_state","shift","_animateEnd","dt","v","_animateFling","_staticEnd","dv","now","../util/svg",3,"triangle","h","half_w","_startX","./draggable",4,"dateTime","tz","utcStr","toUTCString","substring","replace",5,"clickHandler","setupClickHandlers","item","pluginName","method","rootSelector","dataArg","$root","$this","href","is","closest","Class","$document","classname","handler","prefix","selector","specialMethods","dasherize","noClickHandlers","args","instance","test","removeData","error","warn","each","obj","_options","cssScope","before","prefixes","./string",6,"padChar","toLowerCase","capitalize","charAt","toUpperCase",7,"getTransformAttr","createElementNS","defaultValue","exec","parseFloat"],"mappings":"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","file":"edsc-timeline.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","stringUtil = require('./util/string')\npluginUtil = require('./util/plugin')\ndateUtil = require('./util/date')\nsvgUtil = require('./util/svg')\nDraggable = require('./timeline/draggable')\nTemporalFencepost = require('./timeline/fencepost')\n\n# Height for the top area, where arrows are drawn for date selection\nTOP_HEIGHT = 19\n\n# Height for each row, including any necessary margins\nROW_HEIGHT = 26\n\nROW_FONT_HEIGHT = 14\n\nROW_PADDING = 5\n\nOFFSET_X = 48\n\nROW_TEXT_OFFSET = TOP_HEIGHT + ROW_FONT_HEIGHT + ROW_PADDING\n\n# Height for the axis of the timeline, containing date displays\nAXIS_HEIGHT = 40\n\nMS_PER_MINUTE = 60000\n\nMS_PER_HOUR = MS_PER_MINUTE * 60\n\nMS_PER_DAY = MS_PER_HOUR * 24\n\nMS_PER_MONTH = MS_PER_DAY * 31\n\nMS_PER_YEAR = MS_PER_DAY * 366\n\nMS_PER_DECADE = MS_PER_YEAR * 10\n\nMONTHS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n\nMIN_X = -100000\nMIN_Y = -1000\nMAX_X = 100000\nMAX_Y = 1000\n\nformatTime = (date) -> stringUtil.padLeft(date.getUTCHours(), '0', 2) + ':' + stringUtil.padLeft(date.getUTCMinutes(), '0', 2)\nformatDay = (date) -> stringUtil.padLeft(date.getUTCDate(), '0', 2)\nformatMonth = (date) -> MONTHS[date.getUTCMonth()]\nformatDate = (date) -> formatMonth(date) + ' ' + formatDay(date)\nformatYear = (date) -> date.getUTCFullYear()\naddContext = (dateStr, contextMatch, contextFn) ->\n  result = [dateStr]\n  result.push(contextFn()) if dateStr == contextMatch\n  result\n\nLABELS = [\n  ((date) -> addContext(formatTime(date), '00:00', -> formatDate(date))),\n  ((date) -> addContext(formatTime(date), '00:00', -> formatDay(date) + ' ' +formatMonth(date) + ' ' + formatYear(date))),\n  ((date) -> addContext(formatDay(date), '01', -> formatMonth(date) + ' ' + formatYear(date))),\n  ((date) -> addContext(formatMonth(date), 'Jan', -> formatYear(date))),\n  ((date) -> [formatYear(date)]),\n  ((date) -> [formatYear(date)]),\n  ((date) -> [formatYear(date)])\n]\n\nRESOLUTIONS = [\n  'minute',\n  'hour',\n  'day',\n  'month',\n  'year',\n  'year',\n  'year'\n]\n\nZOOM_LEVELS = [\n  MS_PER_MINUTE,\n  MS_PER_HOUR,\n  MS_PER_DAY,\n  MS_PER_MONTH,\n  MS_PER_YEAR,\n  MS_PER_DECADE,\n  MS_PER_DECADE * 5\n]\n\nclass TemporalSelection\n  constructor: (parent, @left, @right, attrs) ->\n    @left.on 'update', @update, this\n    @right.on 'update', @update, this\n\n    @rect = svgUtil.buildSvgElement('rect', attrs)\n    parent.appendChild(@rect)\n    @update()\n\n  dispose: ->\n    {left, right, update, rect} = this\n    left.off 'update', update, this\n    right.off 'update', update, this\n\n    rect.parentNode.removeChild(rect)\n    @rect = null\n\n  update: (attrs) ->\n    x = Math.min(@left.x, @right.x)\n    width = Math.abs(@right.x - @left.x)\n\n    svgUtil.updateSvgElement @rect, $.extend({}, attrs, {x: x, width: width})\n    this\n\n\nclass Timeline extends pluginUtil.Base\n  constructor: (root, namespace, options={}) ->\n    super(root, namespace, options)\n\n    @_rows = []\n\n    @root.addClass('timeline')\n    @root.attr('tabindex', '1')\n    @root.append(@_buildDom())\n    @root.append(@_createDisplay())\n\n    @_data = {}\n\n    @animate = options.animate ? true\n\n    @_zoom = 4\n    @end = (options.end || new Date()) - 0\n    @start = @end - ZOOM_LEVELS[@_zoom]\n    @originPx = 0\n\n    @_loadedRange = []\n\n    @_updateTimeline()\n\n    @root.on 'click.timeline', @scope('.date-label'), @_onLabelClick\n    @root.on 'mouseover.timeline', @scope('.date-label'), @_onLabelMouseover\n    @root.on 'mouseout.timeline', @scope('.date-label'), @_onLabelMouseout\n    @root.on 'mouseover.timeline', @scope('.data'), @_onDataMouseover\n    @root.on 'mouseout.timeline', @scope('.data'), @_onDataMouseout\n    @root.on 'keydown.timeline', @_onKeydown\n\n    @root.on 'focusout.timeline', (e) =>\n      @root.removeClass('hasfocus')\n      @_hasFocus = false\n      @_forceRedraw()\n    @root.on 'focusin.timeline', (e) =>\n      hovered = document.querySelector(\"#{@scope('.date-label')}:hover\")\n      @_onLabelClick(currentTarget: hovered) if hovered?\n      @root.addClass('hasfocus')\n      @_forceRedraw()\n      # We want click behavior when we have focus, but not when the focus came from the\n      # click's mousedown.  Ugh.\n      setTimeout((=> @_hasFocus = true), 500)\n\n  destroy: ->\n    @root.find('svg').remove()\n    @root.off('.timeline')\n    super()\n\n  range: ->\n    # Query and draw bounds that are 3x wider than needed, centered on the visible range.\n    # This prevents an in-progress drag from needing to redraw or re-query\n    {start, end} = this\n    span = end - start\n    [start - span, end + span, RESOLUTIONS[@_zoom - 2]]\n\n  startTime: ->\n    @start\n\n  endTime: ->\n    @end\n\n  show: ->\n    @root.show()\n    @_setHeight()\n    null\n\n  hide: ->\n    @root.hide()\n    @_setHeight()\n    @focus()\n    null\n\n  loadstart: (id, start, end, resolution) ->\n    match = @root[0].getElementsByClassName(id)\n    if match.length > 0\n      match[0].setAttribute('class', \"#{match[0].getAttribute('class')} #{@scope('loading')}\")\n      @_empty(match[0])\n\n  data: (id, data) =>\n    row = @_getRow(id)\n    @_loadedRange = [data.start, data.end, data.resolution]\n    @_data[id] = [data.start, data.end, data.resolution, data.intervals, row.color]\n    @_drawData(id)\n    @_drawIndicators(id)\n\n\n    @_drawData(id)\n    @_drawIndicators(id)\n\n  _drawIndicators: (id) ->\n    row = null\n    for row in @_rows\n      break if row.id == id\n    return unless row?\n\n    [_, _, _, intervals, color] = @_data[id]\n    color = color ? '#25c85b'\n\n    row_min = if row.min then new Date(row.min * 1000) else new Date(0)\n    row_max = if row.max then new Date(row.max * 1000) else new Date()\n\n    before_start =\n      row_max < @start ||\n        intervals.length > 0 && intervals[intervals.length - 1][1] * 1000 < @start\n\n    after_end =\n      row_min > @end ||\n        intervals.length > 0 && intervals[0][0] * 1000 > @end\n\n    before_color = if before_start then color else 'transparent'\n    after_color = if after_end then color else 'transparent'\n    document.getElementById(\"arrow-left-#{id}\").setAttribute('style', \"fill: #{before_color}\")\n    document.getElementById(\"arrow-right-#{id}\").setAttribute('style', \"fill: #{after_color}\")\n    null\n\n  _drawData: (id) ->\n    index = -1\n    for row, i in @_rows\n      if row.id == id\n        index = i\n        break\n    return if index == -1\n\n    zoom = @_zoom\n\n    [start, end, resolution, intervals, color] = @_data[id] ? [@start - 1 , @end + 1, RESOLUTIONS[zoom - 2], [], null]\n\n    match = @root[0].getElementsByClassName(id)\n    el = null\n    if match.length > 0\n      el = match[0]\n      @_empty(el)\n      el.parentNode.removeChild(el)\n    else\n      el = @_buildSvgElement('g')\n      @_translate(el, 0, ROW_HEIGHT * index) if index > 0\n\n    for [startTime, endTime, _] in intervals\n      startPos = @timeToPosition(startTime * 1000)\n      endPos = @timeToPosition(endTime * 1000)\n      attrs =\n        x: startPos\n        y: 5\n        width: endPos - startPos\n        height: ROW_HEIGHT - 7\n        rx: 10\n        ry: 10\n      attrs['class'] = @scope('imprecise') if resolution != RESOLUTIONS[zoom - 2]\n      rect = @_buildSvgElement 'rect', attrs\n      rect.setAttribute('style', \"fill: #{color}\") if color?\n      el.appendChild(rect)\n\n    # Remove 'timeline-loading' class\n    el.setAttribute('class', \"#{id} #{@scope('data')}\")\n\n    @tlRows.appendChild(el)\n\n    @_drawIndicators(id)\n\n    null\n\n  _onDataMouseover: (e) =>\n    tooltip = $('.timeline-tooltip')\n    data = e.target\n\n    id = data.parentNode.className.baseVal.split(' ')[0]\n    resolution = @_data[id][2]\n    intervals = @_data[id][3]\n    nodes = $(e.currentTarget.childNodes)\n    interval = intervals[nodes.index(data)]\n    start = interval[0] * 1000\n    stop = interval[1] * 1000\n    tooltip.find('.inner').text(\"#{@_dateWithResolution(start, resolution)} to #{@_dateWithResolution(stop, resolution)}\")\n\n    matrix = data.getScreenCTM()\n    leftEdge = matrix.e + data.x.baseVal.value\n    rightEdge = leftEdge + data.width.baseVal.value\n    leftEdge = 0 if leftEdge < 0\n    rightEdge = window.innerWidth if rightEdge > window.innerWidth\n    tooltip.css(\"left\", ((leftEdge + rightEdge)/2 - tooltip.width()/2) + \"px\")\n    dataTop = matrix.f\n    timelineTop = $('.timeline').offset().top\n    tooltip.css(\"top\", (dataTop - timelineTop  - 33) + \"px\")\n\n    tooltip.show()\n\n  _onDataMouseout: (e) =>\n    $('.timeline-tooltip').hide()\n\n  _dateWithResolution: (date, resolution) ->\n    str = dateUtil.dateToHumanUTC(date).split(' ')\n    # str is ['03', 'Aug', '1987', '00:00', 'GMT']\n    index = RESOLUTIONS.indexOf(resolution)\n    if index > 1\n      str[3] = ''\n      str[4] = ''\n    if index > 2\n      str[0] = ''\n    if index > 3\n      str[1] = ''\n\n    str.join(' ')\n\n  _forceRedraw: ->\n    rect = @_buildRect(stroke: 'none', fill: 'none')\n    svg = @svg\n    svg.appendChild(rect)\n    callback =  -> svg.removeChild(rect)\n    if window.requestAnimationFrame\n      window.requestAnimationFrame(callback)\n    else\n      setTimeout(callback)\n\n  refresh: ->\n    @rows(@_rows)\n\n  rows: (rows) ->\n    if rows?.length > 0\n      @_rows = ($.extend({}, row) for row in rows)\n      @_updateRowNames()\n      @_drawTemporalBounds()\n      @_empty(@tlRows)\n      @_data = {}\n      @show()\n    else\n      @hide()\n    @_rows\n\n  timeSpanToPx: (t) ->\n    t / @scale\n\n  pxToTimeSpan: (p) ->\n    @scale / p\n\n  timeToPosition: (t) ->\n    {originPx, start, scale} = this\n    originPx + (t - start) / scale\n\n  positionToTime: (p) ->\n    {originPx, start, scale} = this\n    Math.floor((p - originPx) * scale + start)\n\n  zoomIn: ->\n    @root.trigger('buttonzoom')\n    @_deltaZoom(-1)\n\n  zoomOut: ->\n    @root.trigger('buttonzoom')\n    @_deltaZoom(1)\n\n  zoom: (arg) ->\n    if arg?\n      @_deltaZoom(arg - @_zoom)\n      null\n    else\n      @_zoom\n\n  center: (arg) ->\n    if arg?\n      @panToTime(arg + (@end - @start) / 2)\n      null\n    else\n      Math.round((@end + @start) / 2)\n\n  _deltaZoom: (levels, center_t=@center()) ->\n    @_zoom = Math.min(Math.max(@_zoom + levels, 2), ZOOM_LEVELS.length - 1)\n\n    @root.toggleClass(@scope('max-zoom'), @_zoom == ZOOM_LEVELS.length - 1)\n    @root.toggleClass(@scope('min-zoom'), @_zoom == 2)\n\n    # We want to zoom in a way that keeps the center_t at the same pixel so you\n    # can double-click or scoll-wheel to zoom and your mouse stays over the same time\n\n    x = @timeToPosition(center_t)\n\n    timeSpan = ZOOM_LEVELS[@_zoom]\n\n    scale = timeSpan / @width\n\n    @start = center_t - (scale * (x - @originPx))\n    @end = @start + timeSpan\n\n    @scale = scale\n\n    @focus()\n    @_updateTimeline()\n    @_drawTemporalBounds()\n\n  focus: (t0, t1) ->\n    if  Math.abs(t0 - @_focus) < 1000\n      return unless @_hasFocus # Regaining input focus, don't do anything (EDSC-323)\n      t0 = null\n    @_focus = t0\n\n    root = @root\n    overlay = @focusOverlay\n    @_empty(overlay)\n\n    if t0?\n      root.trigger(@scopedEventName('focusset'), [t0, t1, RESOLUTIONS[@_zoom - 1]])\n      startPt = @timeToPosition(t0)\n      stopPt = @timeToPosition(t1)\n\n      left = @_buildRect(class: @scope('unfocused'), x1: startPt)\n      overlay.appendChild(left)\n\n      right = @_buildRect(class: @scope('unfocused'), x: stopPt)\n      overlay.appendChild(right)\n    else\n      root.trigger(@scopedEventName('focusremove'))\n    @_forceRedraw()\n    null\n\n  panToTime: (time) ->\n    @_pan(@timeSpanToPx(@end - time))\n\n  _getTransformX: svgUtil.getTransformX\n\n  _onKeydown: (e) =>\n    focus = @_focus\n    key = e.keyCode\n    left = 37\n    up = 38\n    right = 39\n    down = 40\n    if focus && (key == left || key == right)\n      @root.trigger('arrowpan')\n      zoom = @_zoom - 1\n\n      focusEnd = @_roundTime(focus, zoom, 1)\n\n      if key == left\n        t0 = @_roundTime(focus, zoom, -1)\n        t1 = focus - 1\n        dx = @timeSpanToPx(focusEnd - focus)\n      else\n        t0 = focusEnd\n        t1 = @_roundTime(focus, zoom, 2) - 1\n        dx = -@timeSpanToPx(t1 - t0)\n\n      if @_canFocusTimespan(t0, t1)\n        @_pan(dx)\n        @focus(t0, t1)\n\n  _canFocusTimespan: (start, stop) ->\n    for row in @_rows\n      return true if !row.canFocusTimespan || row.canFocusTimespan(start, stop)\n    false\n\n  _timespanForLabel: (group) ->\n    next = group.previousSibling\n\n    x0 = @_getTransformX(group)\n    x1 = @_getTransformX(next, x0)\n\n    [@positionToTime(x0), @positionToTime(x1) - 1]\n\n  _onLabelClick: (e) =>\n    return if @_dragging\n    @root.trigger('clicklabel')\n    label = e.currentTarget\n    [start, stop] = @_timespanForLabel(label)\n    if @_canFocusTimespan(start, stop)\n      @focus(start, stop)\n\n  _onLabelMouseover: (e) =>\n    label = e.currentTarget\n    [start, stop] = @_timespanForLabel(label)\n    unless @_canFocusTimespan(start, stop)\n      label.setAttribute('class', \"#{@scope('date-label')} #{@scope('nofocus')}\")\n\n  _onLabelMouseout: (e) =>\n    label = e.currentTarget\n    label.setAttribute('class', @scope('date-label'))\n\n  _contains: (start0, end0, start1, end1) ->\n    start0 < start1 < end0 && start0 < end1 < end0\n\n  _empty: (node) ->\n    $(node).empty()\n  # node.innerHTML = '' # Works for browsers but not capybara-webkit\n\n  _buildSvgElement: svgUtil.buildSvgElement\n\n  _translate: (el, x, y) ->\n    el.setAttribute('transform', \"translate(#{x}, #{y})\")\n    el\n\n  _buildDom: ->\n    $('<div class=\"timeline-tools\">\n        <h1></h1>\n        <div class=\"timeline-tools-zoom\">\n          <a class=\"timeline-zoom-in\" href=\"#\">+</a>\n          <a class=\"timeline-zoom-out\" href=\"#\">&#8722;</a>\n        </div>\n      </div>\n\n      <div class=\"timeline-tooltip top\">\n        <div class=\"tooltip-arrow\"></div>\n        <div class=\"inner\"></div>\n      </div>')\n\n  _createDisplay: ->\n    @svg = svg = @_buildSvgElement('svg', class: @scope('display'))\n\n    offset = @root.find(@scope('.tools')).width()\n\n    selection = @_createSelectionOverlay(svg)\n    @_translate(selection, offset, 0)\n\n    top = @_buildRect(class: @scope('display-top'), y: 0, y1: TOP_HEIGHT)\n    @_setupTemporalSelection(top)\n    @_translate(top, offset, 0)\n\n    focus = @_createFocusOverlay(svg)\n    @_translate(focus, offset, 0)\n\n    overlay = @_createFixedOverlay(svg)\n    @_translate(overlay, offset, 0)\n\n    timeline = @_createTimeline(svg)\n    @_translate(timeline, offset, 0)\n\n    svg.appendChild(timeline)\n    svg.appendChild(top)\n    svg.appendChild(overlay)\n    svg.appendChild(selection)\n    svg.appendChild(focus)\n\n    @_setupDragBehavior(svg)\n    @_setupScrollBehavior(svg)\n\n    svg\n\n  _setupTemporalSelection: (el) ->\n    self = this\n    root = @root\n\n    $(el).on 'click', =>\n      root.trigger(@scopedEventName('temporalchange'), [])\n\n    draggable = new Draggable(el, @animate)\n\n    left = null\n    right = null\n\n    draggable.on 'dragstart', ({cursor}) =>\n      overlay = @selectionOverlay\n      @_empty(overlay)\n      [left, right] = @_createSelectionRegion(overlay, cursor.x, cursor.x, [0...@_rows.length])\n\n    draggable.on 'dragmove', (e) -> right._onUpdate(e)\n    draggable.on 'dragend', (e) ->\n      root.trigger('createdtemporal')\n      right._onEnd(e)\n\n  _setupScrollBehavior: (svg) ->\n    allowWheel = true\n\n    rateLimit = ->\n      allowWheel = false\n      setTimeout((-> allowWheel = true), 300)\n\n    getTime = (e) =>\n      draggable = @root.find(@scope('.draggable'))[0]\n      origin = @_getTransformX(draggable)\n\n      x = e.clientX - svg.clientLeft - origin\n      time = @positionToTime(x)\n\n    doScroll = (deltaX, deltaY, time) =>\n      return unless allowWheel\n      if Math.abs(deltaY) > Math.abs(deltaX)\n        levels = if deltaY > 0 then -1 else 1\n        @root.trigger('scrollzoom')\n        @_deltaZoom(levels, time)\n        rateLimit()\n      else if deltaX != 0\n        @root.trigger('scrollpan')\n        @_pan(deltaX)\n\n    # Safari\n    onWheel = (e) ->\n      deltaX = e.wheelDeltaX\n      deltaY = e.wheelDeltaY\n      doScroll(deltaX, deltaY, getTime(e))\n      e.preventDefault()\n\n    svg.addEventListener('mousewheel', onWheel)\n    svg.addEventListener('DOMMouseScroll', onWheel)\n\n    # Chrome/Firefox\n    svg.addEventListener 'wheel', (e) ->\n      return if e.type == \"mousewheel\"\n\n      # 'wheel' deltas are opposite from 'mousewheel'\n      deltaX = -e.deltaX\n      deltaY = -e.deltaY\n      doScroll(deltaX, deltaY, getTime(e))\n\n      e.preventDefault()\n\n    touchSeparation = 0\n    touchCenter = 0\n    svg.addEventListener 'touchstart', (e) ->\n      return unless e.touches && e.touches.length == 2\n      center = (e.touches[0].clientX + e.touches[1].clientX) / 2\n      time = getTime(clientX: center)\n      touchSeparation = Math.abs(e.touches[0].clientX - e.touches[1].clientX)\n      e.preventDefault()\n\n    svg.addEventListener 'touchmove', (e) ->\n      return unless e.touches && e.touches.length == 2\n      deltaY = Math.abs(e.touches[0].clientX - e.touches[1].clientX) - touchSeparation\n      doScroll(0, -deltaY, touchCenter)\n\n  _setupDragBehavior: (svg) ->\n    #draggable = new TimelineDraggable(svg, @animate)\n    el = svg.querySelector(@scope('.draggable'));\n    #draggable = new Draggabilly(el, axis: 'x')\n    draggable = new Draggable(el, @animate)\n\n    dx = 0\n    draggable.on 'dragmove', (e) =>\n      dx = e.offset.x\n      @_dragging = true if Math.abs(dx) > 5\n      @_pan(dx, false)\n    draggable.on 'dragend', (e) =>\n      dx = e.offset.x\n      @root.trigger('draggingpan')\n      @_dragging = false\n      @_pan(dx)\n\n  _pan: (dx, commit=true) ->\n    @_startPan() unless @_panStart?\n\n    start = @_panStart\n    end = @_panEnd\n\n    span = end - start\n    @start = start - dx * @scale\n    @end = @start + span\n\n    @originPx = -(@_panStartX + dx) # x offset from its original position\n\n    draggables = @root.find([@scope('.draggable'), @scope('.selection'), @scope('.display-top'), @scope('.focus')].join(', '))\n    draggables.attr('transform', \"translate(#{-@originPx + OFFSET_X},0)\")\n    @_forceRedraw()\n\n    @_finishPan() if commit\n\n  _startPan: ->\n    draggable = @root.find(@scope('.draggable'))[0]\n    @_panStartX = @_getTransformX(draggable, OFFSET_X) - OFFSET_X\n    @_panStart = @start\n    @_panEnd = @end\n\n  _finishPan: =>\n    @_updateTimeline()\n    @_panStartX = @_panStart = @_panEnd = null\n\n  _createSelectionOverlay: (svg) ->\n    @selectionOverlay = @_buildSvgElement('g', class: @scope('selection'))\n\n  _createFocusOverlay: (svg) ->\n    @focusOverlay = @_buildSvgElement('g', class: @scope('focus'))\n\n  _createFixedOverlay: (svg) ->\n    @overlay = overlay = @_buildSvgElement('g', class: @scope('overlay'))\n\n    @olRows = rows = @_buildSvgElement('g', class: @scope('row'))\n    @_translate(rows, 5, ROW_TEXT_OFFSET)\n\n    overlay.appendChild(rows)\n\n    overlay\n\n  _createTimeline: (svg) ->\n    @timeline = timeline = @_buildSvgElement('g', class: @scope('draggable'))\n\n    background = @_buildSvgElement 'rect',\n      class: @scope('background')\n      x: MIN_X\n      y: MIN_Y\n      width: MAX_X - MIN_X\n      height: MAX_Y - MIN_Y\n\n    @tlRows = rows = @_buildSvgElement('g')\n    @_translate(rows, 0, TOP_HEIGHT)\n\n    @axis = axis = @_buildSvgElement('g')\n    @_translate(axis, 0, TOP_HEIGHT)\n\n    timeline.appendChild(background)\n    timeline.appendChild(axis)\n    timeline.appendChild(rows)\n\n    timeline\n\n  _buildIndicatorArrow: (id, transform) ->\n    g = @_buildSvgElement('g',\n      class: @scope('indicator'),\n      id: id,\n      transform: transform)\n    g.appendChild(@_buildSvgElement('path', d: 'M 0 -5 L 6 1 L 8 -1 L 4 -5 L 8 -9 L 6 -11 z'))\n    g.appendChild(@_buildSvgElement('path', d: 'M 5 -5 L 11 1 L 13 -1 L 9 -5 L 13 -9 L 11 -11 z'))\n    g\n\n  _updateRowNames: ->\n    rows = @_rows\n    overlay = @olRows\n    @_empty(overlay)\n    y = 0\n\n    textGroup = @_buildSvgElement('g')\n\n    for row in rows\n      overlay.appendChild(@_buildIndicatorArrow(\"arrow-left-#{row.id}\", \"translate(0, #{y})\"))\n      overlay.appendChild(@_buildIndicatorArrow(\"arrow-right-#{row.id}\", \"translate(#{@width - 20}, #{y - 10}) rotate(180)\"))\n\n      txt = @_buildSvgElement('text', x: 15, y: y)\n      txt.textContent = row.title\n      textGroup.appendChild(txt)\n      y += ROW_HEIGHT\n\n    overlay.appendChild(textGroup)\n\n    fn = =>\n      bbox = textGroup.getBBox()\n      rect = @_buildSvgElement('rect', x: bbox.x, y: -ROW_FONT_HEIGHT - ROW_PADDING, width: bbox.width, height: y, class: @scope('shadow'))\n      overlay.insertBefore(rect, overlay.firstChild) if overlay.firstChild\n    setTimeout(fn, 0)\n\n    null\n\n  _updateTimeline: ->\n    {axis, timeline, start, end, root} = this\n    zoom = @_zoom\n\n    @_empty(axis)\n\n    root.find('h1').text(RESOLUTIONS[zoom - 1])\n\n    line = @_buildSvgElement('line', class: @scope('timeline'), x1: MIN_X, y1: 0, x2: MAX_X, y2: 0)\n    axis.appendChild(line)\n\n    elWidth = root.width()\n    elWidth = $(window).width() if elWidth == 0\n\n    @width = width = elWidth - root.find(@scope('.tools')).width()\n    @scale = (end - start) / width # ms per pixel\n\n    range = @range()\n\n    @_drawIntervals(range[0], range[1], zoom - 1)\n\n    for own k, _ of @_data\n      @_drawData(k)\n\n    resolution = range[2]\n    [loadedStart, loadedEnd, loadedResolution] = @_loadedRange\n    unless loadedResolution == resolution && @_contains(loadedStart, loadedEnd, start, end)\n      for node in @tlRows.childNodes\n        node.setAttribute('class', \"#{node.getAttribute('class')} #{@scope('loading')}\")\n\n    root.trigger(@scopedEventName('rangechange'), range)\n\n  setTemporal: (ranges) ->\n    @_globalTemporal = ranges\n\n  setRowTemporal: (id, ranges) ->\n    row = @_getRow(id)\n    if row\n      row.temporal = ranges\n\n  _getRow: (id) ->\n    for row in @_rows\n      return row if row.id == id\n    null\n\n  _drawTemporalBounds: ->\n    overlay = @selectionOverlay\n    rows = @_rows\n    @_empty(overlay)\n\n    return unless rows.length > 0\n\n    globalIndexes = []\n    for row, index in rows\n      if row.temporal\n        @_createTemporalRegion(overlay, row.temporal, [index])\n      else\n        globalIndexes.push(index)\n\n    if @_globalTemporal\n      @_createTemporalRegion(overlay, @_globalTemporal, globalIndexes)\n\n  _createSelectionRegion: (overlay, x0, x1, indexes) ->\n    left = new TemporalFencepost(overlay, x0, MAX_Y)\n    right = new TemporalFencepost(overlay, x1, MAX_Y)\n\n    update = ->\n      leftX = Math.min(left.x, right.x)\n      rightX = Math.max(left.x, right.x)\n      start = new Date(@positionToTime(leftX))\n      stop = new Date(@positionToTime(rightX))\n      @root.trigger(@scopedEventName('temporalchange'), start, stop)\n      null\n\n    left.on 'commit', update, this\n    right.on 'commit', update, this\n    left.on 'update', @_forceRedraw, this\n    right.on 'update', @_forceRedraw, this\n\n    for index in indexes\n      new TemporalSelection overlay, left, right,\n        class: @scope('selection-region')\n        y: TOP_HEIGHT + ROW_HEIGHT * index\n        height: ROW_HEIGHT\n    [left, right]\n\n  _createTemporalRegion: (overlay, temporal, indexes) ->\n    for [start, stop] in temporal\n      @_createSelectionRegion(overlay, @timeToPosition(start), @timeToPosition(stop), indexes)\n\n  _buildRect: (attrs) ->\n    attrs = $.extend({x: MIN_X, x1: MAX_X, y: MIN_Y, y1: MAX_Y}, attrs)\n    attrs['width'] ?= (attrs.x1 - attrs.x) | 0\n    attrs['height'] ?= (attrs.y1 - attrs.y) | 0\n    delete attrs.x1\n    delete attrs.y1\n    @_buildSvgElement 'rect', attrs\n\n  _roundTime: (time, zoom, increment=0) ->\n    time = Math.round(time / 1000) * 1000\n    date = new Date(time)\n    components = (date[\"getUTC#{c}\"]() for c in ['FullYear', 'Month', 'Date', 'Hours', 'Minutes'])\n    components = components.slice(0, Math.max(components.length - zoom, 1))\n    # Zoom to decade\n    if zoom == ZOOM_LEVELS.length - 2\n      components[0] = Math.floor(components[0] / 10) * 10\n      increment *= 10\n\n    components[components.length - 1] += increment\n    components.push(0) if components.length == 1\n    Date.UTC(components...)\n\n  _drawIntervals: (start, end, zoom) ->\n    axis = @axis\n\n    start = @_roundTime(start, zoom)\n    end = @_roundTime(end, zoom)\n\n    time = end\n\n    while time >= start\n      date = new Date(time)\n      prev = @_roundTime(time, zoom, -1)\n      next = @_roundTime(time, zoom, 1)\n      interval = @_buildIntervalDisplay(@timeToPosition(time), @timeToPosition(next), LABELS[zoom](date)...)\n      axis.appendChild(interval)\n      time = prev\n\n  _buildIntervalDisplay: (x0, x1, text, subText) ->\n    g = @_buildSvgElement('g', class: @scope('date-label'))\n    @_translate(g, x0, 0)\n    width = x1 - x0\n\n    if x1?\n      # Something to click on\n      bg = @_buildSvgElement 'rect',\n        x: 0\n        y: 0\n        width: width\n        height: MAX_Y - MIN_Y\n      g.appendChild(bg)\n\n    label = @_buildSvgElement('text', x: 5, y: 20, class: \"#{@scope('axis-label')} #{@scope('axis-super-label')}\")\n    label.textContent = text\n\n    lineClass = @scope('tick')\n    lineClass += ' ' + @scope('interval-start') if subText\n    line = @_buildSvgElement('line', class: lineClass, x1: 0, y1: MIN_Y, x2: 0, y2: MAX_Y)\n\n    circle = @_buildSvgElement('circle', class: @scope('tick-crossing'), r: 6, cx: width)\n\n    g.appendChild(line)\n    g.appendChild(circle)\n    g.appendChild(label)\n\n    if subText\n      subLabel = @_buildSvgElement('text', x: 5, y: 34, class: \"#{@scope('axis-label')} #{@scope('axis-sub-label')}\")\n      subLabel.textContent = subText\n      g.appendChild(subLabel)\n\n    g\n\n  _setHeight: ->\n    if @_rows?.length > 0\n      rowsHeight = @_rows.length * ROW_HEIGHT + 2 * ROW_PADDING\n      @_translate(@axis, 0, TOP_HEIGHT + rowsHeight)\n      totalHeight = Math.max(TOP_HEIGHT + rowsHeight + AXIS_HEIGHT, 100)\n      @root.height(totalHeight)\n      $(@svg).height(totalHeight)\n\npluginUtil.create('timeline', Timeline)\n\n# Integration FIXME:\n#\n# _setHeight: ->\n#    $('.master-overlay').masterOverlay().masterOverlay('contentHeightChanged')\n#\n# Implement canFocusTimespan\n# Respond to temporal selection / clear events\n# Set temporal when it changes",null,"svgUtil = require('../util/svg')\n\nbrowserPrefix = (name) ->\n  window['webkit' + name] || window['moz' + name] || window['ms' + name]\n\nrequestAnimFrame = (window.requestAnimationFrame ||\n                    browserPrefix('RequestAnimationFrame') ||\n                   (fn) -> window.setTimeout(fn))\ncancelAnimFrame = (window.cancelAnimationFrame ||\n                   browserPrefix('CancelAnimationFrame') ||\n                   browserPrefix('CancelRequestAnimationFrame') ||\n                  (id) -> window.clearTimeout(id))\n\ngetOffset = (e) ->\n  el = e.target\n  x = y = 0\n\n  while el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)\n    x += el.offsetLeft - el.scrollLeft\n    y += el.offsetTop - el.scrollTop\n    el = el.offsetParent;\n\n  x = e.clientX - x\n  y = e.clientY - y\n\n  {x: x, y: y}\n\nmodule.exports = class Draggable\n  constructor: (element, @animate=true) ->\n    @_dragging = false\n    @_element = element\n    @enable()\n\n  dispose: ->\n    @disable()\n\n  enable: ->\n    el = @_element\n    el.addEventListener(\"mousedown\", @_mousedown)\n    el.addEventListener(\"touchstart\", @_mousedown)\n\n  disable: ->\n    el = @_element\n    el.removeEventListener(\"mousedown\", @_mousedown)\n    el.removeEventListener(\"touchstart\", @_mousedown)\n\n  on: (events, fn, context) ->\n    @_listeners ?= {}\n    context ?= this\n    for event in events.split(' ')\n      @_listeners[event] ?= []\n      @_listeners[event].push([fn, context])\n    this\n\n  off: (events, fn, context) ->\n    @_listeners ?= {}\n    for event in events.split(' ')\n      listeners = @_listeners[event]\n      if listeners?\n        i = 0\n        while i < listeners.length\n          if listeners[i][0] == fn && listeners[i][1] == context\n            listeners.splice(i, 1)\n          else\n            i++\n        if listeners.length == 0\n          delete @_listeners[event]\n    this\n\n  fire: (event, data) ->\n    console.log event, JSON.stringify(data)\n    listeners = @_listeners?[event]\n    return this unless listeners?\n\n    e = $.extend({}, data ? {}, type: event, target: this)\n    fn.call(context, e) for [fn, context] in listeners\n    this\n\n  _mousedown: (e) =>\n    return if e.shiftKey || (e.which != 1 && e.button != 1 && !e.touches)\n    e.stopPropagation()\n    return if @_dragging\n\n    e = e.touches?[0] || e\n    @_preStartCursor = getOffset(e)\n\n    document.addEventListener(\"mousemove\", @_mousemove)\n    document.addEventListener(\"touchmove\", @_mousemove)\n    document.addEventListener(\"mouseup\", @_mouseup)\n    document.addEventListener(\"touchend\", @_mouseup)\n\n  _mousemove: (e) =>\n    return if e.touches?.length > 1\n\n    e = e.touches?[0] || e\n    cursor = getOffset(e)\n    offset = {x: cursor.x - @_preStartCursor.x, y: cursor.y - @_preStartCursor.y}\n\n    return if Math.abs(offset.x) + Math.abs(offset.y) < 3\n\n    e.preventDefault()\n\n    unless @_dragging\n      @_startCursor = cursor\n      @_startLoc = @_currentLoc = @_getLoc()\n\n    @_currentOffset = offset = {x: cursor.x - @_startCursor.x, y: cursor.y - @_startCursor.y}\n    @_currentLoc = {x: @_startLoc.x + offset.x, y: @_startLoc.y + offset.y}\n    @_currentCursor = {x: -@_startLoc.x + @_startCursor.x + offset.x, y: -@_startLoc.y + @_startCursor.y + offset.y}\n\n    @_start() unless @_dragging\n\n    if @animate\n      cancelAnimFrame(@_frameId)\n      @_frameId = requestAnimFrame(=> @_move())\n    else\n      @_move()\n\n  _mouseup: (e) =>\n    document.removeEventListener(\"mousemove\", @_mousemove)\n    document.removeEventListener(\"touchmove\", @_mousemove)\n    document.removeEventListener(\"mouseup\", @_mouseup)\n    document.removeEventListener(\"touchend\", @_mouseup)\n    cancelAnimFrame(@_frameId) if @animate\n    @_end()\n\n  _start: ->\n    @_dragging = true\n    @_positions = []\n    @_times = []\n    @fire('dragstart', @_state())\n\n  _move: ->\n    @fire('predragmove', @_state())\n\n    time = +new Date()\n    @_positions.push(@_currentLoc.x)\n    @_times.push(time)\n\n    if time - @_times[0] > 200\n      @_positions.shift()\n      @_times.shift()\n\n    @fire('dragmove', @_state())\n\n  _animateEnd: ->\n    dx = @_currentLoc.x - @_positions[0]\n    dt = +new Date() - @_times[0]\n    v = dx/dt\n    @_animateFling(v, .01, +new Date())\n\n  _end: ->\n    if @animate && @_positions?.length > 0\n      @_animateEnd()\n    else\n      @_staticEnd()\n\n  _animateFling: (v, a, t) ->\n    now = +new Date()\n    dt = now - t\n    dv = a*dt\n    if v < 0\n      v += dv\n    else\n      v -= dv\n\n    if dv < Math.abs(v)\n      @_currentLoc.x += v * dt\n      @_currentOffset.x += v * dt\n      @_move()\n      requestAnimFrame =>\n        @_animateFling(v, a, now)\n    else\n      @_staticEnd()\n\n  _staticEnd: ->\n    @_dragging = false\n    @fire('dragEnd', @_state())\n\n  _getLoc: ->\n    # FIXME: y\n    {x: svgUtil.getTransformX(@_element), y: 0}\n\n  _state: ->\n    {start: @_startLoc, offset: @_currentOffset, cursor: @_currentCursor}\n","Draggable = require('./draggable')\nsvgUtil = require('../util/svg')\n\nmodule.exports = class TemporalFencepost extends Draggable\n  constructor: (parent, x, @height) ->\n    @line = svgUtil.buildSvgElement('line')\n    @triangle = svgUtil.buildSvgElement('path')\n\n    @update(x)\n\n    parent.appendChild(@line)\n    parent.appendChild(@triangle)\n\n    super(@triangle, true)\n\n    @on 'dragend', @_onEnd, this\n    @on 'predrag', @_onUpdate, this\n\n\n  dispose: ->\n    {line, triangle} = this\n    @line = @triangle = null\n\n    line.parentNode.removeChild(line)\n    triangle.parentNode.removeChild(triangle)\n    @disable()\n\n  update: (x) ->\n    @x = x\n    y = 0\n    half_w = 10\n    h = 10\n    svgUtil.updateSvgElement(@line, x1: x, y1: y + h, x2: x, y2: @height)\n    svgUtil.updateSvgElement(@triangle, d: \"m#{x - half_w} #{y} l #{half_w} #{h} l #{half_w} #{-h} z\")\n    @fire('update', {x: x})\n    this\n\n  _onUpdate: (e) ->\n    @update(e.cursor.x)\n\n  _onEnd: (e) ->\n    @_onUpdate(e.cursor.x)\n    @fire('commit', x: e.cursor.x)\n    @_startX = null\n","exports.dateToHumanUTC = function(date) {\n  var result, dateTime, tz, utcStr;\n  if (date !== null && typeof(date) !== 'undefined') {\n    utcStr = new Date(date).toUTCString();\n    tz = utcStr.substring(utcStr.length-3);\n\n    dateTime = utcStr\n      .replace(/^\\S+\\s/, '')   // Remove leading word (day of week)\n      .replace(/:[^:]*$/, ''); // Remove everything after the minutes\n    // Tack on the time zone code\n    result = dateTime + ' ' + tz;\n    }\n  else {\n    result = 'Unknown';\n  }\n  return result;\n};\n","stringUtil = require('./string')\n\nclickHandler = (pluginName, method, rootSelector, dataArg) ->\n  (e) ->\n    $this = $(this)\n    if $this.is('a') || $(e.target).closest('a').length == 0\n      $root = $this.closest(rootSelector)\n      if $root.length == 0\n        href = $this.attr('href')\n        $root = $(href) if href? && href.length > 1\n\n      $root[pluginName](method, $this.attr(dataArg))\n    false\n\n# Sets up onclick handlers\nsetupClickHandlers = (pluginName, Class) ->\n  specialMethods = ['constructor', 'destroy']\n  $document = $(document)\n  prefix = stringUtil.dasherize(pluginName)\n  rootSelector = \".#{prefix}\"\n\n  for own method, fn of Class.prototype\n    unless method in specialMethods || method.indexOf('_') == 0\n      classname = \"#{prefix}-#{stringUtil.dasherize(method)}\"\n\n      selector = \".#{classname}\"\n      handler = clickHandler(pluginName, method, rootSelector, \"data-#{classname}\")\n      $document.on 'click', selector, handler\n\ncreate = (pluginName, Class) ->\n  setupClickHandlers(pluginName, Class) unless Class.noClickHandlers\n\n  $.fn[pluginName] = (args...) ->\n    if args.length > 0 && typeof args[0] == 'string'\n      # Method call\n      [method, args...] = args\n      result = for el in this\n        instance = $.data(el, pluginName)\n\n        if !instance\n          console.warn \"#{pluginName} not found on element\"\n          el\n\n        else if /^debug_/.test(method)\n          # Calling $el.<pluginName>('debug_attrname') returns the attribute named attrname for\n          # debugging purposes\n          [x, attr...] = method.split('_')\n          instance[attr.join('_')]\n\n        else if method == 'destroy'\n          # Special case when calling the 'destroy' method, we also need to remove its data\n          $.removeData(el, pluginName)\n          instance.destroy() if typeof instance?.destroy == 'function'\n\n        else if !/^_/.test(method) && typeof instance?[method] == 'function'\n          # Calling $el.<pluginName>(method, args...) calls the given method passing the given args\n          instance[method](args...)\n        else\n          console.error \"Could not call #{method} on #{pluginName} instance:\", el\n          null\n      result[0]\n    else if args.length < 2\n      @each ->\n        # Constructor call\n        options = args[0]\n        # Prevent multiple instantiations\n        unless $.data(this, pluginName)?\n          obj = new Class($(this), pluginName, options)\n          $.data(this, pluginName, obj)\n    else\n      console.error \"Bad arguments to #{pluginName}:\", args\n      this\n\nclass Base\n  constructor: (@root, @namespace, @_options) ->\n    @cssScope = stringUtil.dasherize(@namespace)\n\n  destroy: ->\n\n  scope: (name, options={}) ->\n    prefixes = ['.', 'is-']\n\n    before = \"\"\n    for prefix in prefixes when name.indexOf(prefix) == 0\n      before += prefix\n      name = name.substring(prefix.length)\n\n    \"#{before}#{@cssScope}-#{name}\"\n\n  scopedEventName: (name) ->\n    \"#{name}.#{@namespace}\"\n\nexports.create = create\nexports.Base = Base\n","// Pad the given str (string) by prepending the given padChar (string) until it\n// is at least len (int) characters long\nexports.padLeft = function(str, padChar, len) {\n  str = \"\" + str;\n  padChar = \"\" + padChar;\n  while (str.length < len) {\n    str = padChar + str;\n  }\n  return str;\n};\n\n// Convert the string to one which uses dashes instead of spaces and underscores\n// and has dashes between CapWords.\nexports.dasherize = function(str) {\n  return str\n    .replace(/[_\\s]+/g, '-')    // Replace runs of spaces and underscores with dashes\n    .replace(/([A-Z])/g, '-$1') // Insert dashes before capital letters\n    .replace(/-+/g, '-')        // Replace runs of dashes with single dashes\n    .replace(/\\A-/g, '')        // Get rid of leading dashes\n    .replace(/-\\Z/g, '')        // Get rid of trailing dashes\n    .toLowerCase();             // Lowercase\n};\n\n// Capitalize the first letter of the string\nexports.capitalize = function(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n};\n","var getTransformAttr = function(el) {\n  return el.getAttribute('transform')\n    || el.parentNode.getAttribute('transform')\n    || '';\n};\n\nvar getLeftAttr = function(el) {\n  return el.getAttribute('left')\n    || el.parentNode.getAttribute('left')\n    || '';\n};\n\nvar updateSvgElement = function(el, attrs) {\n  var attr;\n  if (attrs != null) {\n    for (attr in attrs) {\n      if (attrs.hasOwnProperty(attr) && attrs[attr] != null) {\n        el.setAttribute(attr, attrs[attr]);\n      }\n    }\n  }\n  return el;\n};\n\nexports.updateSvgElement = updateSvgElement;\n\nexports.buildSvgElement = function(name, attrs) {\n  var el = document.createElementNS('http://www.w3.org/2000/svg', name);\n  return updateSvgElement(el, attrs);\n};\n\nexports.getTransformX = function(el, defaultValue) {\n  var re, match, result, left;\n  result = defaultValue || 0;\n  if (el) {\n    match = /^[^\\d\\-]*(-?[\\d\\.]+)/.exec(getTransformAttr(el));\n    if (match && match[1]) {\n      result = parseFloat(match[1]);\n    }\n  }\n  return result;\n};\n"],"sourceRoot":"/source/"}